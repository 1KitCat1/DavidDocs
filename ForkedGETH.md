# 🍴 Forked GETH node

Node source code: https://gitlab.com/distributed_lab/ethereum-experiments/go-geth-precompiled-contracts


### Starting a node in the development mode

1) Clone the source code of forked node.
2) Enter ***dev-edition*** folder `cd dev-edition`
3) Run docker image of the node `docker compose up`


### Precompiled contract usage

*Ethereum* already have **9** in-built precompiled contract. Precompiled contract for *Groth16* proofs verification is **10th** address.

```solidity
contract ZKPrecompiles {

  event Result(string _result);

  function test_non_precompile () external{
    string memory result = "non-precompile";
    emit Result(result);
  }

  function test_groth_verifier(bytes memory input) external {
    (bool ok, bytes memory out) = address(10).staticcall(input);
    require(ok, "Failed to make a staticcall");
    string memory result = string(out);
    emit Result(result);
  }
}
```


### Gas-cost comparison

Even though this forked node can be used in private networks, where gas cost does not matter, we compared the amount of resources taken by this precompiled contract to the amount of resouces taken by other precompiled contracts (mainly `EcRecover`) to set up fair gas price and prevent node-overload attacks (when execution is too cheap and node can be spammed).

SNARK proofs can also be verified by using already in-build precompiled contracts for elliptic curve operations (contracts `0x6` - &, `0x7` - *ecMul* and `0x8` - *ecPairing*).

Here is gas-price comparison of this two methods for *Groth16*: 

New precompile:
1: *164403*
2: *166199*
3: *168044*

In-built procompiles:
1: *236948*
2: *244438*
3: *251904*

——————————————
Gas increase per one public input:  

Precompiled:   *1796*, *1845*
Autogenerated: *7490*, *7466*

———————————
Difference in gas cost: 

*+44.1%*
*+47.1%*
*+50%*